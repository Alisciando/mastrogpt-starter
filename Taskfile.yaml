version: "3"

dotenv:
  - .env
  - .user

tasks:
  default:
    dir: packages
    cmds:
      - task: mastrogpt:display
      - nuv -wsk project deploy

  mastrogpt:display:
    dir: packages/mastrogpt/display
    cmds:
      - cp ../../../util/virtualenv.zip ../display.zip
      - zip ../display.zip *
    sources:
      - packages/mastrogpt/display/*
      - util/virtualenv.zip
    generates:
      - packages/mastrogpt/display.zip

  clean:
    dir: packages
    cmds:
      - nuv -wsk project undeploy

  setup: |
    python3 -m venv venv
    source venv/bin/activate
    pip install ipython openai requests
    pip install -r util/requirements.txt

  cli: |
    source venv/bin/activate
    ipython -i util/init.ipy
